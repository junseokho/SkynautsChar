<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>탐공사 캐릭터 생성기</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <!-- 외부 CSS -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
<header>
  <h1>톱니바퀴 탑의 탐공사 캐릭터 생성기</h1>
</header>

<main>
  <!-- 기본 정보 -->
  <section class="card">
    <h2>기본 정보</h2>
    <div class="field-group">
      <label for="charName">캐릭터 이름</label>
      <input id="charName" type="text" placeholder="예) 에반">
    </div>
    <div class="field-group">
      <label for="charDescription">캐릭터 설명 / 메모</label>
      <textarea id="charDescription" placeholder="외형, 성격, 배경 등을 자유롭게 적으세요."></textarea>
    </div>
  </section>

  <!-- 종족 및 종족 스킬 -->
  <section class="card">
    <h2>종족 / 종족 스킬</h2>
    <div class="row">
      <div class="col-2">
        <div class="field-group">
          <label for="raceSelect">종족</label>
          <select id="raceSelect">
            <option value="모던 타임즈">모던 타임즈</option>
            <option value="리틀러">리틀러</option>
            <option value="앤티크">앤티크</option>
            <option value="코펠리아">코펠리아</option>
            <option value="퍼리">퍼리</option>
            <option value="플로레스">플로레스</option>
          </select>
          <div class="hint">
            모던 타임즈는 개성 스킬을 3개 습득합니다.
          </div>
        </div>
      </div>
      <div class="col-2">
        <div class="field-group">
          <label for="raceSkillSelect">종족 스킬</label>
          <select id="raceSkillSelect"></select>
          <div class="hint">
            모던 타임즈의 종족 스킬 적응력: 특화 능력을 2개까지 선택 가능.<br>
            모던 타임즈의 종족 스킬 십인십색: 개성 스킬 카드 선택 모드.
          </div>
        </div>
      </div>
    </div>

    <!-- 혼혈용 추가 종족 / 종족 스킬 선택 영역 -->
    <div class="row" id="mixedRaceRow" style="display:none;">
      <div class="col-2">
        <div class="field-group">
          <label for="extraRaceSelect">추가 종족 (혼혈)</label>
          <select id="extraRaceSelect"></select>
          <div class="hint">
            모던 타임즈의 종족 스킬 혼혈을 선택했을 때만 사용합니다. 모던 타임즈 이외의 종족 하나를 선택하세요.
          </div>
        </div>
      </div>
      <div class="col-2">
        <div class="field-group">
          <label for="extraRaceSkillSelect">추가 종족 스킬</label>
          <select id="extraRaceSkillSelect"></select>
          <div class="hint">
            선택한 추가 종족의 종족 스킬 중 하나를 선택합니다.
          </div>
        </div>
      </div>
    </div>

    <!-- 추가 종족 스킬 설명 -->
    <div class="field-group" id="extraRaceSkillDescWrapper" style="display:none;">
      <div class="section-title">추가 종족 스킬 설명 (혼혈)</div>
      <div id="extraRaceSkillDesc" class="skill-preview">
        혼혈로 습득한 추가 종족 스킬의 효과가 여기 표시됩니다.
      </div>
    </div>
    <!-- 혼혈 영역 끝 -->


    <div class="field-group">
      <div class="section-title">종족 특징 설명</div>
      <div id="raceFeatureDesc" class="skill-preview">
        선택한 종족의 기본 특징이 여기 표시됩니다.
      </div>
    </div>

    <div class="field-group">
      <div class="section-title">종족 스킬 설명</div>
      <div id="raceSkillDesc" class="skill-preview">
        선택한 종족 스킬의 효과가 여기 표시됩니다.
      </div>
    </div>
  </section>

  <!-- 능력치 특화/취약 -->
  <section class="card">
    <h2>능력 설정</h2>
    <div class="row">
      <div class="col-2">
        <div class="field-group">
          <label for="specializedAbility">특화 능력 1</label>
          <select id="specializedAbility">
            <option value="기술">기술</option>
            <option value="감각">감각</option>
            <option value="교양">교양</option>
            <option value="신체">신체</option>
          </select>
        </div>
      </div>
      <div class="col-2" id="spec2Wrapper" style="display:none;">
        <div class="field-group">
          <label for="specializedAbility2">추가 특화 능력</label>
          <select id="specializedAbility2">
            <option value="기술">기술</option>
            <option value="감각">감각</option>
            <option value="교양">교양</option>
            <option value="신체">신체</option>
          </select>
          <div class="hint">
            종족 스킬 적응력 또는 개성 스킬 [재능] 천재가 있을 때만 활성화되며, 이 경우 반드시 다른 능력을 특화해야 합니다.
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-2">
        <div class="field-group">
          <label for="weakAbility">취약 능력</label>
          <select id="weakAbility">
            <option value="기술">기술</option>
            <option value="감각">감각</option>
            <option value="교양">교양</option>
            <option value="신체">신체</option>
          </select>
          <div class="hint" id="weakHint">
            기본적으로 취약 능력 1개가 필요합니다. 개성 스킬 [재능] 수재를 얻으면 취약 능력이 아예 사라집니다.
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 개성 스킬 -->
  <section class="card">
    <h2>개성 스킬</h2>

    <div class="field-group">
      <span class="section-title">개성 스킬 선택 방식</span>
      <div class="hint">
        기본: 2개, 모던 타임즈는 3개.<br>
        모던 타임즈 + 십인십색이면 카드 선택 모드, 아니라면 2d6 무작위 굴림을 슬롯별로 사용합니다.
      </div>
    </div>

    <div class="field-group">
      <div class="section-title">
        무작위 굴리기 슬롯
        <span class="badge">카드 모드가 아닐 때 사용</span>
      </div>
      <div id="personalitySlotsContainer" class="slot-list"></div>
      <div class="hint">
        슬롯마다 버튼으로 2d6을 굴려 개성 스킬을 정합니다. 이미 정해진 슬롯도 다시 굴릴 수 있습니다.
      </div>
    </div>

    <div class="field-group">
      <div class="section-title">
        현재 선택된 개성 스킬
        <span id="personalityCountInfo" class="badge"></span>
      </div>
      <div id="personalityPreview" class="skill-preview">
        아직 선택된 개성 스킬이 없습니다.
      </div>
    </div>

    <div class="field-group">
      <div class="section-title">
        카드 선택 모드
        <span class="badge">모던 타임즈 + 십인십색일 때 자동 활성화</span>
      </div>
      <div class="hint">
        조건을 만족하면 아래에 36개의 개성 스킬 카드가 표시되며, 직접 클릭해서 선택할 수 있습니다.
      </div>
      <div id="personalityCardsContainer" class="skill-cards-container"></div>
      <div id="cardModeStatus" class="hint"></div>
    </div>
  </section>

  <!-- 마법 스킬 -->
  <section class="card">
    <h2>마법 스킬</h2>
    <div class="field-group">
      <label for="magicSkillSelect">마법 스킬 선택</label>
      <select id="magicSkillSelect">
        <option value="">선택 안 함</option>
      </select>
      <div id="magicHint" class="hint">
        종족이 앤티크이거나 개성 스킬 [경력] 마법사를 가진 경우에만 선택 가능하며, 그때는 1개를 반드시 선택해야 합니다.
      </div>
    </div>

    <div class="field-group">
      <div class="section-title">마법 스킬 설명</div>
      <div id="magicSkillDesc" class="skill-preview">
        선택한 마법 스킬의 효과가 여기 표시됩니다.
      </div>
    </div>
  </section>

  <!-- 탐공사 스킬 -->
  <section class="card">
    <h2>탐공사 스킬</h2>
    <div class="field-group">
      <label for="explorerSkillSelect">탐공사 스킬</label>
      <select id="explorerSkillSelect">
        <option value="회피운동">회피운동</option>
        <option value="탄도학">탄도학</option>
        <option value="비계공">비계공</option>
      </select>
      <div class="hint">
        세 가지 중 하나를 선택합니다.
      </div>
    </div>

    <div class="field-group">
      <div class="section-title">탐공사 스킬 설명</div>
      <div id="explorerSkillDesc" class="skill-preview">
        선택한 탐공사 스킬의 효과가 여기 표시됩니다.
      </div>
    </div>
  </section>

  <!-- 출력 -->
  <section class="card">
    <h2>코코포리아 캐릭터 생성 JSON</h2>
    <p class="hint">
      아래 JSON을 통째로 복사해서 코코포리아 맵 위를 우클릭 후 붙여넣으면 캐릭터가 생성됩니다.
    </p>

    <div class="field-group">
      <div class="inline-group">
        <button type="button" id="generateApiBtn">
          캐릭터 JSON 생성
        </button>
        <button type="button" id="copyApiBtn" class="btn-secondary">
          클립보드로 복사
        </button>
        <span id="copyStatus" class="hint"></span>
      </div>
    </div>

    <div class="field-group">
      <textarea id="apiOutput" class="output-area" spellcheck="false" placeholder='먼저 "캐릭터 JSON 생성" 버튼을 눌러 주세요.'></textarea>
    </div>

    <div class="footer-note">
      status: 생명점 10/10(기본, 각종 보정 후 자동 조정), 유대 0/6, BS 0/5, 이동력 3/0(기본 3, 각종 보정 후 자동 조정)<br>
      params: 네 능력(기술/감각/교양/신체)을 value "0"/"1"/"2" (문자열)로 저장<br>
      memo: 이름 + 설명 + 종족 + 능력 + 기본 유대/배드 스테이터스 틀 자동 포함
    </div>
  </section>
</main>

  <script type="module" src="js/app.js"></script>
</body>
</html>
